<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Analytics Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 30px;
        }
        
        .stat-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            border-left: 4px solid #667eea;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #666;
            font-size: 1.1rem;
        }
        
        .section {
            padding: 30px;
            border-top: 1px solid #eee;
        }
        
        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .recent-activity {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }
        
        .activity-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-type {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .activity-details {
            flex: 1;
            margin: 0 15px;
            color: #666;
        }
        
        .activity-time {
            color: #999;
            font-size: 0.9rem;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn:hover {
            background: #5a6fd8;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .info {
            background: #e7f3ff;
            color: #0066cc;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .github-pages-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .activity-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Portfolio Analytics</h1>
            <p>Client-side analytics for GitHub Pages hosting</p>
        </div>
        
        <div class="github-pages-notice">
            <h3>‚ÑπÔ∏è GitHub Pages Analytics</h3>
            <p>This analytics dashboard works entirely in your browser using localStorage. Data is stored locally and persists across sessions. For server-side analytics, you would need a different hosting solution.</p>
        </div>
        
        <div class="stats-grid" id="statsGrid">
            <div class="loading">Loading analytics data...</div>
        </div>
        
        <div class="section">
            <h2>üìà Recent Activity</h2>
            <div class="controls">
                <button class="btn" onclick="loadAnalytics()">üîÑ Refresh Data</button>
                <button class="btn btn-secondary" onclick="exportData()">üì• Export Data</button>
                <button class="btn btn-danger" onclick="clearData()">üóëÔ∏è Clear Data</button>
                <a href="index.html" class="btn btn-secondary">üè† Back to Portfolio</a>
            </div>
            <div id="recentActivity" class="recent-activity">
                <div class="loading">Loading recent activity...</div>
            </div>
        </div>
    </div>

    <script>
        // Load analytics data from localStorage
        function loadAnalytics() {
            try {
                // Check if analytics is available
                if (typeof window.analytics === 'undefined') {
                    document.getElementById('statsGrid').innerHTML = '<div class="error">Analytics not initialized. Please visit the main portfolio page first.</div>';
                    document.getElementById('recentActivity').innerHTML = '<div class="error">Analytics not initialized. Please visit the main portfolio page first.</div>';
                    return;
                }
                
                const analyticsData = window.analytics.getAnalyticsData();
                displayStats(analyticsData);
                displayRecentActivity(analyticsData.recent_events);
                
            } catch (error) {
                console.error('Error loading analytics:', error);
                document.getElementById('statsGrid').innerHTML = '<div class="error">Failed to load analytics data</div>';
                document.getElementById('recentActivity').innerHTML = '<div class="error">Failed to load recent activity</div>';
            }
        }
        
        function displayStats(stats) {
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${stats.total_page_views || 0}</div>
                    <div class="stat-label">üìÑ Page Views</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.total_resume_downloads || 0}</div>
                    <div class="stat-label">üì• Resume Downloads</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.unique_sessions || 0}</div>
                    <div class="stat-label">üë• Unique Sessions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.total_form_submissions || 0}</div>
                    <div class="stat-label">üìù Form Submissions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.total_external_clicks || 0}</div>
                    <div class="stat-label">üîó External Clicks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.total_project_interactions || 0}</div>
                    <div class="stat-label">üéØ Project Interactions</div>
                </div>
            `;
        }
        
        function displayRecentActivity(activities) {
            const activityContainer = document.getElementById('recentActivity');
            
            if (!activities || activities.length === 0) {
                activityContainer.innerHTML = '<div class="info">No recent activity. Visit your portfolio pages to start tracking!</div>';
                return;
            }
            
            const activityHTML = activities.reverse().map(activity => `
                <div class="activity-item">
                    <div class="activity-type">${getActivityTypeLabel(activity.event_type)}</div>
                    <div class="activity-details">${getActivityDetails(activity)}</div>
                    <div class="activity-time">${formatTime(activity.timestamp)}</div>
                </div>
            `).join('');
            
            activityContainer.innerHTML = activityHTML;
        }
        
        function getActivityTypeLabel(type) {
            const labels = {
                'page_view': 'üëÅÔ∏è View',
                'resume_download': 'üì• Download',
                'form_submission': 'üìù Form',
                'external_link_click': 'üîó Link',
                'project_interaction': 'üéØ Project',
                'scroll_depth': 'üìú Scroll',
                'time_on_page': '‚è±Ô∏è Time',
                'page_load': 'üöÄ Load',
                'page_exit': 'üëã Exit'
            };
            return labels[type] || type;
        }
        
        function getActivityDetails(activity) {
            const data = activity.data;
            switch (activity.event_type) {
                case 'page_view':
                    return `Page viewed: ${data.title || 'Unknown'}`;
                case 'resume_download':
                    return `Resume downloaded from: ${data.url || 'Unknown page'}`;
                case 'form_submission':
                    return `Form submitted: ${data.form_type || 'Unknown form'}`;
                case 'external_link_click':
                    return `External link clicked: ${data.url || 'Unknown link'}`;
                case 'project_interaction':
                    return `Project interaction: ${data.action || 'Unknown action'}`;
                case 'scroll_depth':
                    return `Scrolled ${data.depth}% of page`;
                case 'time_on_page':
                    return `Spent ${data.time_seconds}s on page`;
                case 'page_load':
                    return `Page loaded in ${Math.round(data.load_time)}ms`;
                case 'page_exit':
                    return `Spent ${Math.round(data.active_time/1000)}s actively on page`;
                default:
                    return `Event: ${activity.event_type}`;
            }
        }
        
        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return Math.floor(diff / 60000) + 'm ago';
            if (diff < 86400000) return Math.floor(diff / 3600000) + 'h ago';
            return date.toLocaleDateString();
        }
        
        function exportData() {
            if (typeof window.analytics !== 'undefined') {
                window.analytics.exportData();
            } else {
                alert('Analytics not initialized. Please visit the main portfolio page first.');
            }
        }
        
        function clearData() {
            if (confirm('Are you sure you want to clear all analytics data? This action cannot be undone.')) {
                if (typeof window.analytics !== 'undefined') {
                    window.analytics.clearData();
                    loadAnalytics();
                    alert('Analytics data cleared successfully.');
                } else {
                    alert('Analytics not initialized.');
                }
            }
        }
        
        // Load analytics on page load
        document.addEventListener('DOMContentLoaded', loadAnalytics);
        
        // Auto-refresh every 30 seconds
        setInterval(loadAnalytics, 30000);
    </script>
</body>
</html>
